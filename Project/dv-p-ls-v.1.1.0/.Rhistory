stat_summary(fun.data = "mean_sdl", geom = "errorbar", width = 0.2, color = "black") +
labs(title = "Average Glucose Level by Dietary Habits",
x = "Dietary Habits", y = "Average Glucose Level") +
theme_minimal() +
theme(text = element_text(size = 12),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right")
stroke_patients <- data[data$Diagnosis == "Stroke",]
symptoms_list <- str_split(stroke_patients$Symptoms, ", ", simplify = FALSE)
symptoms_unlisted <- unlist(symptoms_list)
symptoms_df <- data.frame(Symptom = symptoms_unlisted)
ggplot(symptoms_df, aes(x = Symptom, fill = Symptom)) +
geom_bar() +
coord_flip() +
labs(title = "Symptom Occurrence by Age Group in Stroke Patients",
x = "Symptoms", y = "Count") +
theme_minimal() + scale_fill_viridis_d()
ggplot(data, aes(x = `Stress Levels`)) +
geom_density(fill = "blue", alpha = 0.5) +
facet_wrap(~`Work Type`) +
labs(title = "Stress Levels Distribution by Work Type",
x = "Stress Levels", y = "Density") +
theme_minimal()
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
data$AgeGroup <- cut(data$Age, breaks = seq(min(data$Age), max(data$Age), by = 20), include.lowest = TRUE)
ggplot(data, aes(x = `Stress Levels`, fill = AgeGroup)) +
geom_density(alpha = 0.6) +
labs(title = "Stress Level Distribution Across Age Groups",
x = "Stress Levels", y = "Density") +
theme_minimal() +
scale_fill_viridis(discrete = TRUE)
ggplot(data, aes(x = `Alcohol Intake`)) +
geom_bar(fill = "purple") +
facet_wrap(~`Family History of Stroke`) +
labs(title = "Alcohol Intake and Family History of Stroke",
x = "Alcohol Intake", y = "Count") +
coord_cartesian(ylim = c(1750, 2000)) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Average Glucose Level`, fill = Gender)) +
geom_histogram(binwidth = 10, position = "identity", alpha = 0.7, color = "white") +
labs(title = "Distribution of Average Glucose Level by Gender and Age Group",
x = "Average Glucose Level", y = "Frequency") +
facet_grid(Gender ~ Age_Group) +
theme_minimal()
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Physical Activity`, y = `Body Mass Index (BMI)`, fill = Age_Group)) +
stat_summary(fun = mean, geom = "bar", position = "dodge") +
labs(title = "Average Body Mass Index (BMI) by Physical Activity and Age Group",
x = "Physical Activity", y = "Average Body Mass Index (BMI)") +
scale_fill_viridis_d() +
coord_cartesian(ylim = c(25, 30))
theme_minimal()
ggplot(data, aes(x = `Residence Type`, fill = Diagnosis)) +
geom_bar(position = "fill", stat = "count") +
labs(title = "Stroke Occurrences by Residence Type",
x = "Residence Type",
y = "Count",
fill = "Diagnosis") +
scale_fill_manual(values = c("purple", "grey"), labels = c("No Stroke", "Stroke")) +
theme_minimal()
ggplot(data, aes(x = Diagnosis, fill = Diagnosis)) +
geom_bar() +
facet_wrap(~ `Marital Status`) +
labs(title = "Marital status and the incidence of strokes",
x = "Diagnosis",
y = "Frequency") +
theme_minimal() +
scale_fill_manual(values = c("Stroke" = "#34495E", "No Stroke" = "#58D68D")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
coord_cartesian(ylim = c(2250, 2500))
ggplot(data, aes(x = `Work Type`, y = Age, fill = Diagnosis)) +
geom_boxplot() +
labs(title = "Relationship between Work Type and Age by Diagnosis",
x = "Work Type", y = "Age") +
scale_fill_manual(values = c("No Stroke" = "Light Blue", "Stroke" = "Orange")) +
theme_minimal()
ggplot(data, aes(x = Age, fill = `Smoking Status`)) +
geom_histogram(binwidth = 5, alpha = 0.8) +
labs(title = "Age Distribution by Stroke Diagnosis", x = "Age", y = "Count") + scale_fill_brewer(palette = "Set1") +
scale_fill_manual(values = c("Non-smoker" = "#85929E",
"Formerly Smoked" = "#E74C3C",
"Currently Smokes" = "#34495E")) +
theme_minimal()
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History Legend",
x = 0.8, y = 0.9,
bordercolor = "rgba(0, 0, 0, 0.5)",  # Legend border color
borderwidth = 2,  # Legend border width
font = list(family = "Arial", size = 12, color = "black"),  # Legend font
itemsizing = "constant",  # Legend item sizing
traceorder = "normal"  # Legend trace order
ggplot(data, aes(x = Age, fill = `Smoking Status`)) +
geom_histogram(binwidth = 5, alpha = 0.8) +
labs(title = "Age Distribution by Smoking Status", x = "Age", y = "Count") + scale_fill_brewer(palette = "Set1") +
scale_fill_manual(values = c("Non-smoker" = "#85929E",
"Formerly Smoked" = "#E74C3C",
"Currently Smokes" = "#34495E")) +
theme_minimal()
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Physical Activity`, y = `Body Mass Index (BMI)`, fill = Age_Group)) +
stat_summary(fun = mean, geom = "bar", position = "dodge") +
labs(title = "Average Body Mass Index (BMI) by Physical Activity and Age Group",
x = "Physical Activity", y = "Average Body Mass Index (BMI)") +
scale_fill_viridis_d() +
coord_cartesian(ylim = c(25, 30))
theme_minimal()
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+")),
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Physical Activity`, y = `Body Mass Index (BMI)`, fill = Age_Group)) +
stat_summary(fun = mean, geom = "bar", position = "dodge") +
labs(title = "Average Body Mass Index (BMI) by Physical Activity and Age Group",
x = "Physical Activity", y = "Average Body Mass Index (BMI)") +
scale_fill_viridis_d() +
coord_cartesian(ylim = c(25, 30)) + theme_minimal()
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History",
x = 0.8, y = 0.9,
bordercolor = "rgba(0, 0, 0, 0.5)",  # Legend border color
borderwidth = 2,  # Legend border width
font = list(family = "Arial", size = 12, color = "black"),  # Legend font
itemsizing = "constant",  # Legend item sizing
traceorder = "normal"  # Legend trace order
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History",
x = 0.8, y = 0.9,
bordercolor = "rgba(0, 0, 0, 0.5)",  # Legend border color
borderwidth = 2,  # Legend border width
font = list(family = "Arial", size = 12, color = "black"),  # Legend font
itemsizing = "constant",  # Legend item sizing
traceorder = "normal")  # Legend trace order
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History Legend",
x = 0.8, y = 0.9,  # Adjust the position of the legend
xanchor = "center", yanchor = "top",  # Anchor point
bgcolor = "rgba(255, 255, 255, 0.5)",  # Legend background color
bordercolor = "rgba(0, 0, 0, 0.5)",  # Legend border color
borderwidth = 2,  # Legend border width
font = list(family = "Arial", size = 12, color = "black"),  # Legend font
itemsizing = "constant",  # Legend item sizing
traceorder = "normal"  # Legend trace order
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History Legend",
x = 0.8, y = 0.9,  # Adjust the position of the legend
xanchor = "center", yanchor = "top",  # Anchor point
bgcolor = "rgba(255, 255, 255, 0.5)",  # Legend background color
bordercolor = "rgba(0, 0, 0, 0.5)",  # Legend border color
borderwidth = 2,  # Legend border width
font = list(family = "Arial", size = 12, color = "black"),  # Legend font
itemsizing = "constant",  # Legend item sizing
traceorder = "normal")  # Legend trace order
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
legend = list(title = "Stroke History Legend",
traceorder = "normal")  # Legend trace order
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`), symbols = ~as.factor(`Stroke History`),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
install.packages("latexpdf")
install_tinytex()
install.packages("tinytex")
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,          color = ~as.factor(`Stroke History`),          text = ~ifelse(`Stroke History` == 0, "No Stroke", "Stroke"),           hoverinfo = "text+x+y+z+color",           symbols = ~ifelse(`Stroke History`== 0, "No Stroke", "Stroke"),          type = "scatter3d", mode = "markers") %>%   layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",          scene = list(xaxis = list(title = 'Average Glucose Level'),                       yaxis = list(title = 'BMI'),                       zaxis = list(title = 'Age')))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(plotly)
library(stringr)
library(viridis)
data <- read_excel("heart_stroke_data.xls")
data <- na.omit(data)
ggplot(data, aes(x = `Work Type`, fill = as.factor(`Heart Disease`))) +
geom_bar(position = "fill") +
facet_wrap(~`Smoking Status`) +
labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",
x = "Work Type", y = "Proportion", fill = "Heart Disease") +
theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),
labels = c("No Heart Disease", "Heart Disease")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = Work Type, fill = as.factor(`Heart Disease`))) +       geom_bar(position = "fill") +       facet_wrap(~`Smoking Status`) +       labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",            x = "Work Type", y = "Proportion", fill = "Heart Disease") +        theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),                     labels = c("No Heart Disease", "Heart Disease")) +        coord_cartesian(ylim = c(0.4, 0.6)) +   theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = `Work Type`, fill = as.factor(`Heart Disease`))) +
geom_bar(position = "fill") +
facet_wrap(~`Smoking Status`) +
labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",
x = "Work Type", y = "Proportion", fill = "Heart Disease") +
theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),                     labels = c("No Heart Disease", "Heart Disease")) +
coord_cartesian(ylim = c(0.4, 0.6)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = `Dietary Habits`, y = Average Glucose Level, fill = `Dietary Habits`)) +   geom_violin(scale = "count", adjust = 1.5, alpha = 0.7) +
ggplot(data, aes(x = `Dietary Habits`, y = `Average Glucose Level`, fill = `Dietary Habits`)) +   geom_violin(scale = "count", adjust = 1.5, alpha = 0.7) +
scale_fill_brewer(palette = "Paired") + stat_summary(fun = "mean",geom = "crossbar",                color = "#E74C3C") +
stat_summary(fun = "median", geom = "crossbar", color = "#21618C") +
labs(title = "Average Glucose Level by Dietary Habits", x = "Dietary Habits",
y = "Average Glucose Level") +
theme_minimal() +
theme(text = element_text(size = 12), axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "right")
ggplot(data, aes(x = Diagnosis, fill = Diagnosis)) +
geom_bar() +
facet_wrap(~ `Marital Status`) +
labs(title = "Marital Status and The Incidence of Strokes",
x = "Diagnosis",
y = "Frequency") +
theme_minimal() +
scale_fill_manual(values = c("Stroke" = "#34495E", "No Stroke" = "#58D68D")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
coord_cartesian(ylim = c(2250, 2500))
runApp('dv-p')
runApp('dv-p')
runApp('dv-p')
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(plotly)
library(stringr)
library(viridis)
library(readxl)
library(plotly)
library(stringr)
library(viridis)
data <- read_excel("heart_stroke_data.xls")
data <- na.omit(data)
ggplot(data, aes(x = `Work Type`, fill = as.factor(`Heart Disease`))) +
geom_bar(position = "fill") +
facet_wrap(~`Smoking Status`) +
labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",
x = "Work Type", y = "Proportion", fill = "Heart Disease") +
theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),
labels = c("No Heart Disease", "Heart Disease")) +
coord_cartesian(ylim = c(0.4, 0.6)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = `Work Type`, fill = as.factor(`Heart Disease`))) +
geom_bar(position = "fill") +
facet_wrap(~`Smoking Status`) +
labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",
x = "Work Type", y = "Proportion", fill = "Heart Disease") +
theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),
labels = c("No Heart Disease", "Heart Disease")) +
coord_cartesian(ylim = c(0.4, 0.6)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = `Dietary Habits`, y = `Average Glucose Level`, fill = `Dietary Habits`)) +
geom_violin(scale = "count", adjust = 1.5, alpha = 0.7) +
scale_fill_brewer(palette = "Paired") +
stat_summary(fun = "mean",
geom = "crossbar",
color = "#E74C3C") +
stat_summary(fun = "median",
geom = "crossbar",
color = "#21618C") +
labs(title = "Average Glucose Level by Dietary Habits",
x = "Dietary Habits", y = "Average Glucose Level") +
theme_minimal() +
theme(text = element_text(size = 12),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right")
stroke_patients <- data[data$Diagnosis == "Stroke",]
symptoms_list <- str_split(stroke_patients$Symptoms, ", ", simplify = FALSE)
symptoms_unlisted <- unlist(symptoms_list)
symptoms_df <- data.frame(Symptom = symptoms_unlisted)
ggplot(symptoms_df, aes(x = Symptom, fill = Symptom)) +
geom_bar() +
coord_flip() +
labs(title = "Symptom Occurrence by Age Group in Stroke Patients",
x = "Symptoms", y = "Count") +
theme_minimal() + scale_fill_viridis_d()
ggplot(data, aes(x = `Stress Levels`)) +
geom_density(fill = "blue", alpha = 0.5) +
facet_wrap(~`Work Type`) +
labs(title = "Stress Levels Distribution by Work Type",
x = "Stress Levels", y = "Density") +
theme_minimal()
ggplot(data, aes(x = `Stress Levels`)) +
geom_density(fill = "blue", alpha = 0.5) +
facet_wrap(~`Work Type`) +
labs(title = "Stress Levels Distribution by Work Type",
x = "Stress Levels", y = "Density") +
theme_minimal()
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`),
text = ~ifelse(`Stroke History` == 0, "No Stroke", "Stroke"),
hoverinfo = "text+x+y+z+color",
symbols = ~ifelse(`Stroke History`== 0, "No Stroke", "Stroke"),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
data$AgeGroup <- cut(data$Age, breaks = seq(min(data$Age), max(data$Age), by = 20), include.lowest = TRUE)
ggplot(data, aes(x = `Stress Levels`, fill = AgeGroup)) +
geom_density(alpha = 0.6) +
labs(title = "Stress Level Distribution Across Age Groups",
x = "Stress Levels", y = "Density") +
theme_minimal() +
scale_fill_viridis(discrete = TRUE)
ggplot(data, aes(x = `Alcohol Intake`)) +
geom_bar(fill = "purple") +
facet_wrap(~`Family History of Stroke`) +
labs(title = "Alcohol Intake and Family History of Stroke",
x = "Alcohol Intake", y = "Count") +
coord_cartesian(ylim = c(1750, 2000)) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Average Glucose Level`, fill = Gender)) +
geom_histogram(binwidth = 10, position = "identity", alpha = 0.7, color = "white") +
labs(title = "Distribution of Average Glucose Level by Gender and Age Group",
x = "Average Glucose Level", y = "Frequency") +
facet_grid(Gender ~ Age_Group) +
theme_minimal()
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Physical Activity`, y = `Body Mass Index (BMI)`, fill = Age_Group)) +
stat_summary(fun = mean, geom = "bar", position = "dodge") +
labs(title = "Average Body Mass Index (BMI) by Physical Activity and Age Group",
x = "Physical Activity", y = "Average Body Mass Index (BMI)") +
scale_fill_viridis_d() +
coord_cartesian(ylim = c(25, 30)) + theme_minimal()
ggplot(data, aes(x = `Residence Type`, fill = Diagnosis)) +
geom_bar(position = "fill", stat = "count") +
labs(title = "Stroke Occurrences by Residence Type",
x = "Residence Type",
y = "Count",
fill = "Diagnosis") +
scale_fill_manual(values = c("purple", "grey"), labels = c("No Stroke", "Stroke")) +
theme_minimal()
ggplot(data, aes(x = Diagnosis, fill = Diagnosis)) +
geom_bar() +
facet_wrap(~ `Marital Status`) +
labs(title = "Marital Status and The Incidence of Strokes",
x = "Diagnosis",
y = "Frequency") +
theme_minimal() +
scale_fill_manual(values = c("Stroke" = "#34495E", "No Stroke" = "#58D68D")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
coord_cartesian(ylim = c(2250, 2500))
ggplot(data, aes(x = `Work Type`, y = Age, fill = Diagnosis)) +
geom_boxplot() +
labs(title = "Relationship between Work Type and Age by Diagnosis",
x = "Work Type", y = "Age") +
scale_fill_manual(values = c("No Stroke" = "Light Blue", "Stroke" = "Orange")) +
theme_minimal()
ggplot(data, aes(x = Age, fill = `Smoking Status`)) +
geom_histogram(binwidth = 5, alpha = 0.8) +
labs(title = "Age Distribution by Smoking Status", x = "Age", y = "Count") + scale_fill_brewer(palette = "Set1") +
scale_fill_manual(values = c("Non-smoker" = "#85929E",
"Formerly Smoked" = "#E74C3C",
"Currently Smokes" = "#34495E")) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(plotly)
library(stringr)
library(viridis)
data <- read_excel("heart_stroke_data.xls")
data <- na.omit(data)
ggplot(data, aes(x = `Work Type`, fill = as.factor(`Heart Disease`))) +
geom_bar(position = "fill") +
facet_wrap(~`Smoking Status`) +
labs(title = "Heart Disease Prevalence by Work Type and Smoking Status",
x = "Work Type", y = "Proportion", fill = "Heart Disease") +
theme_minimal() + scale_fill_manual(values = c("0" = "#C0392B", "1" = "#AAB7B8"),
labels = c("No Heart Disease", "Heart Disease")) +
coord_cartesian(ylim = c(0.4, 0.6)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = `Dietary Habits`, y = `Average Glucose Level`, fill = `Dietary Habits`)) +
geom_violin(scale = "count", adjust = 1.5, alpha = 0.7) +
scale_fill_brewer(palette = "Paired") +
stat_summary(fun = "mean",
geom = "crossbar",
color = "#E74C3C") +
stat_summary(fun = "median",
geom = "crossbar",
color = "#21618C") +
labs(title = "Average Glucose Level by Dietary Habits",
x = "Dietary Habits", y = "Average Glucose Level") +
theme_minimal() +
theme(text = element_text(size = 12),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right")
stroke_patients <- data[data$Diagnosis == "Stroke",]
symptoms_list <- str_split(stroke_patients$Symptoms, ", ", simplify = FALSE)
symptoms_unlisted <- unlist(symptoms_list)
symptoms_df <- data.frame(Symptom = symptoms_unlisted)
ggplot(symptoms_df, aes(x = Symptom, fill = Symptom)) +
geom_bar() +
coord_flip() +
labs(title = "Symptom Occurrence by Age Group in Stroke Patients",
x = "Symptoms", y = "Count") +
theme_minimal() + scale_fill_viridis_d()
ggplot(data, aes(x = `Stress Levels`)) +
geom_density(fill = "blue", alpha = 0.5) +
facet_wrap(~`Work Type`) +
labs(title = "Stress Levels Distribution by Work Type",
x = "Stress Levels", y = "Density") +
theme_minimal()
plot_ly(data, x = ~`Average Glucose Level`, y = ~`Body Mass Index (BMI)`, z = ~Age,
color = ~as.factor(`Stroke History`),
text = ~ifelse(`Stroke History` == 0, "No Stroke", "Stroke"),
hoverinfo = "text+x+y+z+color",
symbols = ~ifelse(`Stroke History`== 0, "No Stroke", "Stroke"),
type = "scatter3d", mode = "markers") %>%
layout(title = "3D Scatter Plot: Stroke Risk by Glucose Level, BMI, and Age",
scene = list(xaxis = list(title = 'Average Glucose Level'),
yaxis = list(title = 'BMI'),
zaxis = list(title = 'Age')))
data$AgeGroup <- cut(data$Age, breaks = seq(min(data$Age), max(data$Age), by = 20), include.lowest = TRUE)
ggplot(data, aes(x = `Stress Levels`, fill = AgeGroup)) +
geom_density(alpha = 0.6) +
labs(title = "Stress Level Distribution Across Age Groups",
x = "Stress Levels", y = "Density") +
theme_minimal() +
scale_fill_viridis(discrete = TRUE)
ggplot(data, aes(x = `Alcohol Intake`)) +
geom_bar(fill = "purple") +
facet_wrap(~`Family History of Stroke`) +
labs(title = "Alcohol Intake and Family History of Stroke",
x = "Alcohol Intake", y = "Count") +
coord_cartesian(ylim = c(1750, 2000)) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Average Glucose Level`, fill = Gender)) +
geom_histogram(binwidth = 10, position = "identity", alpha = 0.7, color = "white") +
labs(title = "Distribution of Average Glucose Level by Gender and Age Group",
x = "Average Glucose Level", y = "Frequency") +
facet_grid(Gender ~ Age_Group) +
theme_minimal()
data$Age_Group <- cut(data$Age, breaks = c(0, 30, 60, Inf),
labels = c("0-30", "31-60", "60+"))
ggplot(data, aes(x = `Physical Activity`, y = `Body Mass Index (BMI)`, fill = Age_Group)) +
stat_summary(fun = mean, geom = "bar", position = "dodge") +
labs(title = "Average Body Mass Index (BMI) by Physical Activity and Age Group",
x = "Physical Activity", y = "Average Body Mass Index (BMI)") +
scale_fill_viridis_d() +
coord_cartesian(ylim = c(25, 30)) + theme_minimal()
ggplot(data, aes(x = `Residence Type`, fill = Diagnosis)) +
geom_bar(position = "fill", stat = "count") +
labs(title = "Stroke Occurrences by Residence Type",
x = "Residence Type",
y = "Count",
fill = "Diagnosis") +
scale_fill_manual(values = c("purple", "grey"), labels = c("No Stroke", "Stroke")) +
theme_minimal()
ggplot(data, aes(x = Diagnosis, fill = Diagnosis)) +
geom_bar() +
facet_wrap(~ `Marital Status`) +
labs(title = "Marital Status and The Incidence of Strokes",
x = "Diagnosis",
y = "Frequency") +
theme_minimal() +
scale_fill_manual(values = c("Stroke" = "#34495E", "No Stroke" = "#58D68D")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
coord_cartesian(ylim = c(2250, 2500))
ggplot(data, aes(x = `Work Type`, y = Age, fill = Diagnosis)) +
geom_boxplot() +
labs(title = "Relationship between Work Type and Age by Diagnosis",
x = "Work Type", y = "Age") +
scale_fill_manual(values = c("No Stroke" = "Light Blue", "Stroke" = "Orange")) +
theme_minimal()
ggplot(data, aes(x = Age, fill = `Smoking Status`)) +
geom_histogram(binwidth = 5, alpha = 0.8) +
labs(title = "Age Distribution by Smoking Status", x = "Age", y = "Count") + scale_fill_brewer(palette = "Set1") +
scale_fill_manual(values = c("Non-smoker" = "#85929E",
"Formerly Smoked" = "#E74C3C",
"Currently Smokes" = "#34495E")) +
theme_minimal()
